@model SmartBoard.Models.PoaViewModal

@{
    ViewData["Title"] = "Nuevo de POA";
    ViewData["PageName"] = "intel_records_dashboard";
    ViewData["Category1"] = "";
    ViewData["Heading"] = "<i class='subheader-icon fal fa-chart-area'></i> Alta de <span class='fw-300'>POA's</span>";

}


@section HeadBlock {
    @*<link id="mytheme" rel="stylesheet" media="screen, print" href="~/css/themes/cust-theme-13.css">*@
    <link rel="stylesheet" media="screen, print" href="~/css/fa-brands.css">
    <link rel="stylesheet" media="screen, print" href="~/css/formplugins/select2/select2.bundle.css">
    <style>

        .clsObra {
            border-color: #E5E5E5 !important;
        }
    </style>

}

@section SubheaderBlock {
    <div class="subheader-block d-lg-flex align-items-center">
        <div class="d-flex mr-4">
            <div class="mr-2">
                <span class="peity-donut" data-peity="{ &quot;fill&quot;: [&quot;#967bbd&quot;, &quot;#ccbfdf&quot;],  &quot;innerRadius&quot;: 14, &quot;radius&quot;: 20 }">7/10</span>
            </div>
            <div>
                <label class="fs-sm mb-0 mt-2 mt-md-0">Nuevas Secciones</label>
                <h4 class="font-weight-bold mb-0">70.60%</h4>
            </div>
        </div>
        <div class="d-flex mr-0">
            <div class="mr-2">
                <span class="peity-donut" data-peity="{ &quot;fill&quot;: [&quot;#2196F3&quot;, &quot;#9acffa&quot;],  &quot;innerRadius&quot;: 14, &quot;radius&quot;: 20 }">3/10</span>
            </div>
            <div>
                <label class="fs-sm mb-0 mt-2 mt-md-0">Pagina Vista </label>
                <h4 class="font-weight-bold mb-0">14,134</h4>
            </div>
        </div>
    </div>
}



<div class="row">
    <div class="col-xl-12">
        <div id="panel-expediente" class="panel">
            <div class="panel-hdr">
                <h2>
                    Nuevo <span class="fw-300"><i>POA</i></span>
                </h2>
            </div>
            <div class="panel-container show">
                <div class="panel-content">
                    <div id="DivNuevoPOA">

                        <h5>Datos Generales</h5>


                        <div class="row">
                            <div class="col-md-12">
                                <form class="needs-validation" novalidate asp-action="CreateExpediente" id="frmCreateObra">
                                    <div class="panel-content">
                                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                                        <input type="hidden" asp-for="Id" />
                                        <div class="form-row form-group">
                                            <div class="col-md-2 mb-2">

                                                <label asp-for="Years" class="control-label">
                                                </label>

                                                <select asp-for="Years" class="custom-select clsObra select2" required asp-items="ViewBag.Years"></select>
                                                <small>Selecciona el año con el que se identificar al <b>POA</b></small>
                                            </div>

                                            <div class="col-md-2 mb-2">
                                                <label asp-for="Fechaelabora" class="control-label"></label>
                                                <input asp-for="Fechaelabora" class="form-control clsObra" />
                                                <span asp-validation-for="Fechaelabora" class="text-danger"></span>
                                            </div>
                                            <div class="col-md-2 mb-2">
                                                <label asp-for="Fechaactualizacion" class="control-label"></label>
                                                <input asp-for="Fechaactualizacion" class="form-control clsObra" />
                                                <span asp-validation-for="Fechaactualizacion" class="text-danger"></span>
                                            </div>

                                            <div class="col-md-6 mb-2">
                                                <label asp-for="Nombre" class="control-label"></label>
                                                <input asp-for="Nombre" class="form-control clsObra" placeholder="Requerido*" required />
                                                <span asp-validation-for="Nombre" class="text-danger"></span>
                                            </div>

                                        </div>

                                        <div class="form-row">
                                            <div class="col-md-6 mb-2">

                                                <label asp-for="Ideje" class="control-label"></label>
                                                <select asp-for="Ideje" class="custom-select clsObra select2" placeholder="Requerido*" required asp-items="ViewBag.Ideje"></select>
                                            </div>
                                            <div class="col-md-6 mb-2">

                                                <label asp-for="Idobjetivo" class="control-label"></label>
                                                <select asp-for="Idobjetivo" class="custom-select clsObra select2" placeholder="Requerido*" required asp-items="ViewBag.Idobjetivo"></select>
                                            </div>
                                            <div class="col-md-6 mb-2">

                                                <label asp-for="Idestrategia" class="control-label"></label>
                                                <select asp-for="Idestrategia" class="custom-select clsObra select2" placeholder="Requerido*" required asp-items="ViewBag.Idestrategia"></select>
                                            </div>
                                            <div class="col-md-6 mb-2">

                                                <label asp-for="Idlineaaccion" class="control-label"></label>
                                                <select asp-for="Idlineaaccion" class="custom-select clsObra select2" placeholder="Requerido*" required asp-items="ViewBag.Idlineaaccion"></select>
                                            </div>
                                        </div>



                                        <div class="form-group form-row">

                                            @*<button class="btn btn-primary" type="submit">Agregar +</button>*@
                                            @*<button type="button" class="btn btn-primary" data-toggle="modal" data-target=".default-example-modal-right-lg" data-backdrop="static" data-keyboard="false" onclick="crearPOADetalle();">Agregar +</button>*@
                                            <a asp-controller="PoaDetalle" asp-action="CreatePartial" asp-route-idpoa="@Model.Id" class="btn btn-primary">Agregar +</a>
                                        </div>


                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>

                </div>
            </div>

        </div>
    </div>
    @*<div class="col-xl-12">


            <div class="modal fade default-example-modal-right-lg" tabindex="-1" role="dialog" aria-hidden="true">
                <div class="modal-dialog modal-dialog-right modal-lg">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title h4">Especificaciones POA</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true"><i class="@(Settings.Theme.IconPrefix) fa-times"></i></span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div id="DivPoaPartial">
                                <div id="loader" class="spinner-border" role="status">
                                    <span class="sr-only">Loading...</span>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
                            <button type="button" class="btn btn-primary">Guardar</button>
                        </div>
                    </div>
                </div>
            </div>


        </div>*@

</div>
<div class="row">
    <div class="col-xl-12">
        <div class="form-row form-group">

            <table class="table table-bordered table-hover table-striped w-100">
                <thead class="bg-warning-200">
                    <tr>
                        <th>Fecha de Inicio</th>
                        <th>Fecha de Termino</th>
                        <th>Ente Publico</th>
                        <th>Objetivo</th>
                        <th>Actividades</th>
                        <th>Fuente</th>
                        <th>Monto $</th>
                        <th>Metas</th>
                        <th>Indicadores</th>
                        <th>Eje</th>
                        <th>Objectivo</th>
                        <th>Estrategia</th>
                        <th>Linea de Acción</th>
                        <th>CDS</th>
                        <th>Meta</th>
                        <th>Area Responsable</th>
                        <th>Periodo de Monitoreo</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.PoaDetalle)
                    {
                        <tr>
                            <td>@item.Fechainicio.ToShortDateString()</td>
                            <td>@item.Fechatermino.ToShortDateString()</td>
                            <td></td>
                            <td>@item.Objetivo</td>
                            <td>@item.Actividades</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td>
                                <a asp-controller="PoaDetalle" asp-action="EditPartial" asp-route-id="@item.Id" class="btn btn-primary">Editar</a>
                            </td>
                        </tr>
                    }

                </tbody>
            </table>
        </div>


    </div>
</div>


@*<div>
        <a asp-action="Index">Back to List</a>
    </div>*@


@section ScriptsBlock {
    <script src="~/js/statistics/peity/peity.bundle.js"></script>
    <script src="~/js/statistics/flot/flot.bundle.js"></script>
    <script src="~/js/statistics/easypiechart/easypiechart.bundle.js"></script>
    <script src="~/js/datagrid/datatables/datatables.bundle.js"></script>
    <script src="~/js/formplugins/select2/select2.bundle.js"></script>

    <script>
     function crearPOADetalle() {
              $('#DivPoaPartial').load('@Url.Action("CreatePartial", "PoaDetalle")?idpoa='+@Model.Id)
            }
    </script>

    <script type="text/javascript">




        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();
    </script>

    <script>
        $(function () {
            //$('.select2').select2();

            @*var urleje = '@Url.Action("getEjes", "Poa")';
            fillDDL(urleje, "Ideje", "--- Selecciona Eje ---");*@


            @*var urlobjetivo = '@Url.Action("getObjetivos", "Poa")?ideje='+0;
            fillDDL(urlobjetivo, "Idobjetivo", "--- Selecciona Objetivo ---");

            var urlestrategia = '@Url.Action("getEstrategia", "Poa")?idobjetivo=' + 0;
            fillDDL(urlestrategia, "Idestrategia", "--- Selecciona Estrategia ---");

            var urllineaacion = '@Url.Action("getLineaAccion", "Poa")?idestrategia=' + 0;
            fillDDL(urllineaacion, "Idlineaaccion", "--- Selecciona Linea Acción ---");*@


            $("#Ideje").change(function () {
                var ideje = $("#Ideje option:selected").val();
                var urlobjetivo = '@Url.Action("getObjetivos", "Poa")?ideje='+ideje;
                fillDDL(urlobjetivo, "Idobjetivo", "--- Selecciona Objetivo ---");

            });

            $("#Idobjetivo").change(function () {
                var idjetivo = $("#Idobjetivo option:selected").val();
                var urlestrategia = '@Url.Action("getEstrategia", "Poa")?idobjetivo=' + idjetivo;
                fillDDL(urlestrategia, "Idestrategia", "--- Selecciona Estrategia ---");
            });

            $("#Idestrategia").change(function () {
                var idestrategia = $("#Idestrategia option:selected").val();
                var urllineaacion = '@Url.Action("getLineaAccion", "Poa")?idestrategia=' + idestrategia;
                fillDDL(urllineaacion, "Idlineaaccion", "--- Selecciona Linea Acción ---");
            });

            function fillDDL(url, elementId, defaultText) {
                $.getJSON(url, null, function (data) {
                    var items = "<option value>" + defaultText + "</option>";
                    $.each(data, function (i, item) {
                        //console.log(item);
                        items = items + "<option value='" + item.value + "'>" + item.text + "</option>";
                    });
                    $("#" + elementId).html(items);
                })
            }





        })
    </script>
}
